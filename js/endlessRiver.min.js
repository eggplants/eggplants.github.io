jQuery.fn.endlessRiver=function(a){a=jQuery.extend({speed:100,pause:true,buttons:false},a);return this.each(function(){var t=jQuery;var q=t(this);var p="ER_"+new Date().getTime();q.wrap('<div id="'+p+'"></div>');q.css({margin:"0 !important",padding:"0 !important"});var n,i;var m=true;var g=q.offset().left;var b=1;q.children("li.tick-clones").remove();q.addClass("newsticker");var v=q.wrap("<div class='mask'></div>");var d=q.parent().wrap("<div class='tickercontainer'></div>");var k=q.children("li");var s=function(){b=1;q.append(k.clone(true).addClass("tick-clones"));q.children("li").each(function(j){b+=t(this,j).outerWidth(true)})};var r=d.outerWidth(true);while(b<r){s()}q.width(b);q.height(q.parent().height());function o(l,j){q.animate({left:"-="+l},j,"linear",function(){q.children("li:first").appendTo(q);q.css("left",0);n=q.children("li:first").outerWidth(true);i=j/l*n;if(m){o(n,i)}})}n=q.children("li:first").outerWidth(true);i=n/a.speed*1000;o(n,i);function h(){q.off("mouseenter mouseleave");q.hover(f,c)}function f(){t("#"+p+" .er-controls > .pause").toggleClass("play glyphicon-play pause glyphicon-pause");m=false;q.stop()}function c(){t("#"+p+" .er-controls > .play").toggleClass("play glyphicon-play pause glyphicon-pause");m=true;var w=q.offset().left;var j=w+q.children("li:first").outerWidth(true)-g;var l=i/n*j;o(j,l)}if(a.pause){h()}if(a.buttons){var e=t('<ul class="er-controls"><li class="prev glyphicon glyphicon-chevron-left"></li><li class="pause glyphicon glyphicon-pause"></li><li class="next glyphicon glyphicon-chevron-right"></li></ul>');e.insertAfter(d);t("body").on("click","#"+p+" .er-controls > .pause",function(){if(!m){return false}t(this).toggleClass("pause glyphicon-pause play glyphicon-play");q.off("mouseenter mouseleave");m=false});t("body").on("click","#"+p+" .er-controls > .play",function(){if(m){return false}t(this).toggleClass("pause glyphicon-pause play glyphicon-play");m=true;h();var w=q.offset().left;var j=w+q.children("li:first").outerWidth(true)-g;var l=i/n*j;o(j,l)});var u=false;t("body").on("click","#"+p+" .er-controls > .next",function(){if(m){t("#"+p+" .er-controls > .pause").toggleClass("pause glyphicon-pause play glyphicon-play");m=false;return}if(u){return false}var l=q.children("li:first").outerWidth(true);var j=l/a.speed*1000;u=true;q.stop(true,true).animate({left:"-="+l},j,"linear",function(){q.children("li:first").appendTo(q);q.css("left",0);u=false})});t("body").on("click","#"+p+" .er-controls > .prev",function(){if(m){t("#"+p+" .er-controls > .pause").toggleClass("pause glyphicon-pause play glyphicon-play");m=false;return}if(u){return false}var l=q.children("li:last").outerWidth(true);q.css("left","-"+l+"px");q.children("li:last").prependTo(q);var j=l/a.speed*1000;u=true;q.stop(true,true).animate({left:"+="+l},j,"linear",function(){u=false})})}})};
